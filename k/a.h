#define __(z) r(_(z),_r(a))
#define mn (mx?:nx)
#include"z.h"//__%%ll
_f(_r,$(rx,--rx)_j[bx]^=1L<<kx;x)

ZU R,A,X;V _V[64<<15];U _j[16];i0 _J[16*64];f(v,R(tx,1,*(U*)sr=*(U*)&x))f(_v,_x(t(tx,b(1L<<bt[tx])&*(U*)sx)))
_f(f0,4>tx?ti(-ix):te(-ex))_f(f1,te(1./ex))
_F(_a,U X=(U)sx;Ub;$3(tx-2,i(n6(nx),P(b=b_(ga==Gx),i<<6|bs(b))),i(n4(nx),P(b=b2(ia==Ix),i<<4|bs(b))),i(n4(nx),P(b=b2(ia<Ix),i<<4|bs(b))));-1)
D(V,PQ,Z2 _;if(!_){i(_=16,j6 a=PQ();P|=a[0];a=PQ();Q|=a[0])i(1e3,Va=PQ())}Q^=P;P=(P<<55|P>>9)^Q^Q<<14;Q=Q<<37|Q>>27;P+Q)
Ve(l_,s6 i=x;x=127<<23|(1<<23)-1&i;C(e6,(i>>23)-127)+(x-1)*p6(3.1157899f,-3.324199f,2.5988452f,-1.2315303f,.31821337f,-.034436006f))
Ve(_l,e6 i=C(e6,C(s6,x-.5));x-=i;(1+i)*p6(.99999994f,.69315308f,.24015361f,.055826318f,.0089893397f,.0018775767f))

#define Rn(n,r,z) {R=(U)(r);j(n6(n),*(V*)R=_(z);R+=64)}
#define Rz(z) Rn(Nr,sr,z) 
#define X(z) r(rx?(--rx,tz(tx,nx)):x,X=(U)sx;Rz(z))
g(z,R(3>x?x?4:3:tx,i,$(3>x,Rz($3(ix,I2|j<<4,C(e6,I2|j<<4)/(e2)i,(e6)(127<<23|(i6)PQ()>>9)-1)))Rz(3>tx?gx-z0:ix-z2)))_G(nr,X=x;Rn(i,sa,Gx)a)inx(ln,R(tx,n,nr(Nr,r,ox(i))))
F(cat,Qr(aa)Qt(ta!=tx|2>ta)Qz(ma|mx)x=ax?v(x):x;_x(r(tn(ta,na+nx)>x(a,bx)?__(nr(Nx,tz(ta,na+nx),(U)sx)):a+nx,cc=Na%64;Vb=c>I0;X=(U)sx-c;Rn(c+Nx,sr+Na-c,j?Gx:b&*(V*)R|~b&Gx))))
